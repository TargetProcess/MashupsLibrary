tau.mashups.addModule("Level3HierarchyMashup/config", {
    "portfolioTypeCustomFieldName": "PortfolioType",
    "portfolios": [
        {
            "name": "Portfolio",
            "relationDirection": {
                "me": "inbound",
                "other": "outbound"
            },
            "entityTypes": {
                "me": ["epic", "feature", "userstory"],
                "other": ["epic", "feature", "userstory"]
            },
            "itemTabWhiteLists": {
                "me": {
                    "epic": ["description", "features"],
                    "feature": ["description", "userstories"],
                    "userstory": ["description", "tasks"]
                }
            },
            "visualization": {
                "me": {
                    "type": "tab",
                    "options": {
                        "name": "Portfolio Items",
                        "insertAfter": "description",
                        "itemsView": {
                            "type": "simple.list"
                        }
                    }
                },
                "other": {
                    "type": "tab",
                    "options": {
                        "name": "Work Items",
                        "insertAfter": "relations",
                        "itemsView": {
                            "type": "simple.list"
                        }
                    }
                }
            }
        }
    ]
}
);
/*! v0.0.7 Build Tue Oct 02 2018 20:35:11 GMT+0300 (Belarus Standard Time) */
!function(){var e={},t=function(){var t,n,r,o=Array.prototype.slice.call(arguments,0);"string"==typeof o[0]?(r=o[0],t=o[1],n=o[2]):Array.isArray(o[0])&&(t=o[0],n=o[1]);var i=t.reduce(function(e,t){return e.addDependency(t)},tau.mashups);return i=i.addDependency(r+"/config"),i=i.addMashup(function(){var o=Array.prototype.slice.call(arguments,0);if(t.length>0&&1===o.length)throw new Error("Can't properly load dependencies for mashup \""+r+'", mashup is stopped.');return e.variables=o[o.length-1],o.length-t.length===2?e.config=o[o.length-2]:e.config={},Object.freeze&&(Object.freeze(e.variables),Object.freeze(e.config),Object.freeze(e)),n.apply(null,o)})};t("Level3HierarchyMashup",["Underscore","jQuery","component.creator","tau/configurations/definitions/entity.new.list.unit.factory","tau/utils/utils.base64hashEncoder"],function(t,n,r,o,i){return function(t){function n(e){if(r[e])return r[e].exports;var o=r[e]={exports:{},id:e,loaded:!1};return t[e].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var r={};return n.m=t,n.c=r,n.p="",n.p=e.variables?e.variables.mashupPath:n.p,n(0)}([function(e,t,n){e.exports=n(2)},,function(t,n,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var i=r(3),a=r(6),u=o(a),l=r(10),f=o(l),c=r(11),s=r(39),p=r(36),d=r(19),y=r(20),m=r(21),h=r(28),_=r(29),b=r(23),v=r(26),g=r(40),w=r(41),P=r(42),C=r(44),T=r(43),O=r(46),j=r(45),x=r(47),R=(0,i.preprocessConfig)(e.config),k=f["default"].link,I=new u["default"];I.register(s.entityViewName,new s.EntityViewProxy({portfolioTypeCustomFieldName:R.portfolioTypeCustomFieldName,portfolioConfigs:R.portfolios})).register(c.tabsName,new c.TabsProxy({portfolioTypeCustomFieldName:R.portfolioTypeCustomFieldName,portfolioConfigs:R.portfolios,portfolioRelationType:k})).register(p.portfolioItemEmbeddedNewListName,new p.PortfolioItemEmbeddedNewListProxy).register(d.portfolioItemContainerName,new d.PortfolioItemContainerProxy({portfolioTypeCustomFieldName:R.portfolioTypeCustomFieldName,portfolioRelationType:k})).register(y.portfolioItemListName,new y.PortfolioItemListProxy).register(m.portfolioItemAddTriggerName,new m.PortfolioItemAddTriggerProxy({portfolioTypeCustomFieldName:R.portfolioTypeCustomFieldName,portfolioRelationType:k})).register(h.portfolioItemInnerListName,new h.PortfolioItemInnerListProxy).register(_.portfolioItemFilterName,new _.PortfolioItemFilterProxy({portfolioRelationType:k})).register(b.portfolioItemQuickAddName,new b.PortfolioItemQuickAddProxy({portfolioRelationType:k})).register(v.portfolioItemFinderEmbedderName,new v.PortfolioItemFinderEmbedderProxy).register(g.relationContainerName,new g.RelationContainerProxy({portfolioRelationType:k})).register(w.relationListName,new w.RelationListProxy).register(P.relationAddTriggerName,new P.RelationAddTriggerProxy).register(C.relationFilterName,new C.RelationFilterProxy({portfolioRelationType:k})).register(C.relationFilterName,new C.RelationFilterProxy({portfolioRelationType:k})).register(T.relationQuickAddName,new T.RelationQuickAddProxy({portfolioRelationType:k})).register(O.relationTabContainerName,new O.RelationTabContainerProxy({portfolioRelationType:k})).register(j.relationConnectionName,new j.RelationConnectionProxy({portfolioRelationType:k})).register(x.relationTypeChoiceName,new x.RelationTypeChoiceProxy({portfolioRelationType:k}))},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e){return e.reduce(function(e,t){return e.push.apply(e,r((0,l.flatten)((0,l.values)(t.entityTypes)))),e},[])}function i(e,t,n,r){return{relationDirection:e,entityTypes:t,itemTabWhiteLists:n,visualization:r}}function a(e,t){return(0,l.keys)(e).reduce(function(n,r){return n[r]=t(e[r]),n},{})}function u(e){var t=e.portfolios||[];return t.forEach(function(e){e.relationDirection=a(e.relationDirection,function(e){return(0,f.toRelationDirection)(e.toLowerCase())}),e.entityTypes=a(e.entityTypes,function(e){return e.map(function(e){return e.toLowerCase()})})}),e}Object.defineProperty(t,"__esModule",{value:!0}),t.allEntityTypes=o,t.makeConfigParser=i,t.preprocessConfig=u;var l=n(4),f=n(5)},function(e,n){e.exports=t},function(e,t){"use strict";function n(e){switch(e){case o.INBOUND:return r.MASTER;case o.OUTBOUND:return r.SLAVE;default:return null}}Object.defineProperty(t,"__esModule",{value:!0}),t.toRelationDirection=n;var r=t.relationDirections={MASTER:"master",SLAVE:"slave"},o=t.configRelationDirections={INBOUND:"inbound",OUTBOUND:"outbound"}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(7),u=n(8),l=r(u),f=n(9),c=r(f),s=function(){function e(){o(this,e),this._componentProxies={},this._plugIn()}return i(e,[{key:"register",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(this._componentProxies[e]){var o;(o=this._componentProxies[e]).push.apply(o,n)}else this._componentProxies[e]=n;return this}},{key:"_plugIn",value:function(){var t=this,n=l["default"].create.bind(l["default"]);l["default"].create=function(r,o){var i=n(r,o);if(!o)return i;try{var u=o[c["default"]]||o.name,l=t._componentProxies[u];if(l){var f=i.fire.bind(i);i.fire=function(t,n){for(var r=arguments.length,o=Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];var u=e.getEventProxies(l,t);u.reduce(function(e,t){return e.then(function(e){try{return t(e)||e}catch(t){return console.log("Event proxying error in level3-hierarchy-mashup mashup",t,t.stack),e}})},(0,a.when)(n)).then(function(e){return f.apply(void 0,[t,e].concat(o))})}}}catch(e){console.log("Component proxying error in level3-hierarchy-mashup mashup",e,e.stack)}return i}}}],[{key:"getEventProxies",value:function(e,t){return e.reduce(function(e,n){var r=n.eventProxies[t];return r&&e.push(r),e},[])}}]),e}();t["default"]=s},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o="portfolio-tab-"+(0,r.now)()+"-name";t["default"]=o},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={dependency:{id:1,name:"Dependency"},blocker:{id:2,name:"Blocker"},relation:{id:3,name:"Relation"},link:{id:4,name:"Link"},duplicate:{id:5,name:"Duplicate"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n){var r=n.itemTabWhiteLists(e),o=r&&r[t.name],i=o&&o.map(function(e){return e.toLowerCase()});if(i){var a=n.inverse.visualization(e).options,u=a.name;return i.push(u.toLowerCase()),i}return[]}Object.defineProperty(t,"__esModule",{value:!0}),t.TabsProxy=t.tabsName=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(7),c=n(4),s=n(12),p=r(s),d=n(13),y=r(d),m=n(15),h=n(16),_=r(h),b=n(3),v=n(38),g=r(v),w="portfolio.item.tab";t.tabsName="tabs",t.TabsProxy=function(e){function t(e){var n;return o(this,t),n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(t){return n._initialize(t,e)},"destroy":function(){return n._resetTabCaches()}}))}return a(t,e),l(t,[{key:"_initialize",value:function(e,t){var n=this,r=e.context,o=r.entity;if(!o)return e;var i=o.entityType.name.toLowerCase(),a=(0,c.unique)((0,b.allEntityTypes)(t.portfolioConfigs)),u=(0,c.contains)(a,i);return u?(this._storageService=new y["default"](r.configurator),(0,m.getItemTypeConfigByContext)(r,{customFieldName:t.portfolioTypeCustomFieldName,portfolioConfigs:t.portfolioConfigs,visualizationType:g["default"].TAB},this._storageService).then(function(o){var i=n._mayBeAddPortfolioItemTabs(e,o,t.portfolioRelationType,t.portfolioTypeCustomFieldName,r);return(0,f.when)(i,o)}).then(function(e,t){return n._maybeFilterTabsByWhiteLists(e,t)})):e}},{key:"_resetTabCaches",value:function(){this._storageService&&this._storageService.destroy()}},{key:"_mayBeAddPortfolioItemTabs",value:function(e,t,n,r,o){var i=this;if(null===t)return(0,f.when)(e);var a=t.inverseItemType,u=t.entityType,l=t.portfolioConfigs,c=t.configParser;return l.reduce(function(e,t){return e.then(function(e){return i._mayBeAddPortfolioItemTab(e,t,n,r,a,c,o,u)})},(0,f.when)(e))}},{key:"_mayBeAddPortfolioItemTab",value:function(e,t,n,r,o,i,a,u){var l=this,s=(0,c.contains)(i.entityTypes(t),u.name);if(s){var p=i.inverse.visualization(t).options,d=p.itemsView,y=p.name,m=p.insertAfter;return this._createPortfolioItemTabConfig(t,n,r,o,i,a,d,y).then(function(t){return null!==t&&l._insertTabAtPositionConfigured(e.tabs,t,m),e})}return(0,f.when)(e)}},{key:"_createPortfolioItemTabConfig",value:function(e,t,n,r,o,i,a,u){return(0,_["default"])(a,e,t,n,r,o,i,u,this._storageService).then(function(e){if(null===e)return null;var t={label:u,name:(0,c.uniqueId)(w+"_")};return(0,c.extend)(t,e)})}},{key:"_insertTabAtPositionConfigured",value:function(e,t,n){var r=n&&n.toLowerCase(),o=n?(0,c.findIndex)(e,function(e){return e.label.toLowerCase()===r})+1:0;0===o?e.push(t):e.splice(o,0,t)}},{key:"_maybeFilterTabsByWhiteLists",value:function(e,t){if(null===t)return e;var n=t.entityType,r=t.portfolioConfigs,o=void 0===r?[]:r,i=t.configParser,a=(0,c.flatten)(o.map(function(e){return u(e,n,i)})),l=(0,c.unique)(a);return l.length>0&&(e.tabs=e.tabs.filter(function(e){return(0,c.contains)(l,e.label.toLowerCase())})),e}}]),t}(p["default"])},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){n(this,e),this._eventProxies=t}return r(e,[{key:"eventProxies",get:function(){return this._eventProxies}}]),e}();t["default"]=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return Array.isArray(e)?e:Array.from(e)}function i(e,t){return e.entityFieldName+'=="'+t+'"'}function a(e){return"("+e.entityFieldName+"==null)"}function u(e,t,n){return e?"(process.id=="+t.process.id+"&&"+i(t,n)+")":"(process.id!="+t.process.id+"||"+a(t)+")"}function l(e,t,n){var r=o(t),i=r[0],a=r.slice(1),l=u(e,i,n),f=e?"||":"&&";return a.reduce(function(t,r){return""+t+f+u(e,r,n)},l)}function f(e,t,n,r){if(0===n.length)return[];var o=l(t===y.itemTypes.PORTFOLIO,n,r);return e.findAll("project?take=1000&select=id&where=("+encodeURIComponent(o)+")")}function c(){m.cache={},h.cache={},_.cache={}}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u["return"]&&u["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=n(4),y=n(14),m=(0,d.memoize)(function(e,t){return e.findAll("customfields?take=1000&select=({process,entityFieldName})"+("&where=("+encodeURIComponent('name=="'+t+'"&&entityType.name=="Project"')+")"))},function(e,t){return t}),h=(0,d.memoize)(function(e,t,n){return m(e,n.name).then(function(r){return f(e,t,r,n.value)})},function(e,t,n){return t+"|"+n.name+"|"+n.value}),_=(0,d.memoize)(function(e,t,n){return e.findAll("project?select={customFieldValue:"+encodeURIComponent(n)+"}&where=(id=="+t+")").then(function(e){var t=p(e,1),n=t[0].customFieldValue;return{customFieldValue:n}})},function(e,t,n){return t+"|"+n}),b=function(){function e(t){r(this,e),this._store2=t.getStore2()}return s(e,[{key:"retrieveKnownItemPossibleProjectIds",value:function(e,t){return h(this._store2,e,t)}},{key:"retrieveProjectCustomField",value:function(e,t){return _(this._store2,e,t)}},{key:"destroy",value:function(){c()}}]),e}();t["default"]=b},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemTypes={NONE:"none",PORTFOLIO:"portfolio",WORK:"work"}},function(e,t,n){"use strict";function r(e,t){return(0,y.find)(e.getCustomFields(),function(e){return e.name===t})}function o(e,t,n){var o=r(e,t);if(!o)return(0,d.when)({customFieldValue:null});var i=e.getProjectId();return n.retrieveProjectCustomField(i,o.entityFieldName)}function i(e,t){var n=e.customFieldValue;if(null===n)return{name:m.itemTypes.WORK};var r=(0,y.pluck)(t,"name"),o=(0,y.contains)(r,n);return o?{name:m.itemTypes.PORTFOLIO,value:n}:{name:m.itemTypes.NONE}}function a(e,t,n,r){return o(e,t,r).then(function(e){return i(e,n)})}function u(e,t,n,r){return{inverseItemType:e,entityType:t,portfolioConfigs:n,configParser:r}}function l(e,t,n,r){return e&&(0,y.contains)(t.entityTypes(e)||[],n.name)&&t.inverse.visualization(e).type===r}function f(e,t,n,r){var o=(0,y.extend)({},_,{inverse:b}),i=(0,y.find)(n,function(e){return e.name===t});return l(i,o,e,r)?u(m.itemTypes.WORK,e,[i],o):null}function c(e,t,n){var r=(0,y.extend)({},b,{inverse:_}),o=(0,y.filter)(t,function(t){return l(t,r,e,n)});return o.length>0?u(m.itemTypes.PORTFOLIO,e,o,r):null}function s(e,t,n,r){var o=t.entityType,i=(0,y.extend)(o,{name:o.name.toLowerCase()});switch(e.name){case m.itemTypes.WORK:return c(i,n,r);case m.itemTypes.PORTFOLIO:return f(i,e.value,n,r);default:return null}}function p(e,t,n){var r=t.customFieldName,o=t.portfolioConfigs,i=t.visualizationType;return a(e,r,o,n).then(function(t){return s(t,e.entity,o,i)})}Object.defineProperty(t,"__esModule",{value:!0}),t.getItemTypeConfigByContext=p;var d=n(7),y=n(4),m=n(14),h=n(3),_=(0,h.makeConfigParser)(function(e){return e.relationDirection.me},function(e){return e.entityTypes.me},function(e){return e.itemTabWhiteLists.me},function(e){return e.visualization.me}),b=(0,h.makeConfigParser)(function(e){return e.relationDirection.other},function(e){return e.entityTypes.other},function(e){return e.itemTabWhiteLists.other},function(e){return e.visualization.other})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r,o,i,u,f,s){var d=e.type,y=void 0===d?a["default"].SIMPLE_LIST:d,m=e.options,h=new p["default"](u,{name:r,value:t.name},s);return h.generateContext(o).then(function(e){return null===e?null:y===a["default"].SIMPLE_LIST?(0,l["default"])(t,n,r,o,f,e,i):y===a["default"].HIERARCHY_LIST?(0,c["default"])(m,t,r,o,f,e,u):null})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var i=n(17),a=r(i),u=n(18),l=r(u),f=n(31),c=r(f),s=n(37),p=r(s)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={SIMPLE_LIST:"simple.list",HIERARCHY_LIST:"hierarchy.list"}},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t,n){return e+".project.customValues['"+t+"']==\""+n+'"'}function i(e,t,n,r,i,a){var u=i.id,l=a.map(function(e){return"'"+e+"'"}).join(),f="relationType.id=="+u+" and "+e+".entityType.name in ["+l+"]";return t===c.itemTypes.PORTFOLIO&&(f+=" and "+o(e,n,r)),"totalRelationCount:"+e+"Relations.Where("+f+").Count()"}function a(e,t,n,i){if(t===c.itemTypes.WORK)return null;var a=o(e,n,i);return r({},e,a)}function u(e,t,n,r,o,u,c){var p=c.inverse.relationDirection(e);return(0,l.when)({header:[{type:"label.relationCount",text:o,lazy:!0,dataSelector:i(p,r,n,e.name,t,c.inverse.entityTypes(e))}],items:[{type:"relations.container",name:s.portfolioItemContainerName,portfolioConfig:(0,f.extend)({},e,{customFieldName:n,inverseItemType:r,configParser:c,acid:u.acid}),relationsFilter:a(p,r,n,e.name)}]})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=u;var l=n(7),f=n(4),c=n(14),s=n(19)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PortfolioItemContainerProxy=t.portfolioItemContainerName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(4),f=n(12),c=r(f),s=n(20),p=n(29),d=n(25),y=n(30),m=n(27);t.portfolioItemContainerName="portfolio item container",t.PortfolioItemContainerProxy=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(e){return n._initialize(e)},"public.relationsReady":function(e){return n._filterRelations(e)}}));return n._options=e,n}return a(t,e),u(t,[{key:"_initialize",value:function(e){var t=this;this._initConfig=e;var n=e.portfolioConfig,r=n.configParser;return this._relationDirection=r.inverse.relationDirection(n),e.portfolioConfig=n,e.entityTypes=(0,m.toEntityTypes)(r.inverse.entityTypes(n)),e.relationTypes=[this._options.portfolioRelationType],e.children=(0,l.filter)(e.children,function(e){return"relations.filter"===e.type||"relations.list"===e.type&&e.relationConfig.dependencyType===t._relationDirection}),(0,d.configureDirectChildrenOfType)(e.children,"relations.list",s.portfolioItemListName,{portfolioConfig:n,relationConfig:{extensionsConfig:{RelationsDenied:function e(){o(this,e)}}}}),(0,d.configureDirectChildrenOfType)(e.children,"relations.filter",p.portfolioItemFilterName,{portfolioConfig:n}),e}},{key:"_filterRelations",value:function(e){return(0,y.filterRelationsByTypeAndDirection)(e,this._options.portfolioRelationType,this._relationDirection)}}]),t}(c["default"])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PortfolioItemListProxy=t.portfolioItemListName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(4),f=n(12),c=r(f),s=n(21),p=n(28),d=n(25);t.portfolioItemListName="portfolio item list",t.PortfolioItemListProxy=function(e){function t(){var e;return o(this,t),e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(t){return e._initialize(t)}}))}return a(t,e),u(t,[{key:"_initialize",value:function(e){e.relationConfig=(0,l.extend)(e.relationConfig,{headerText:null,helpText:null});var t=e.portfolioConfig;return(0,d.configureDirectChildrenOfType)(e.children,"relations.add.trigger",s.portfolioItemAddTriggerName,{portfolioConfig:t}),(0,d.configureDirectChildrenOfType)(e.children,"list.editable",p.portfolioItemInnerListName,{portfolioConfig:t}),e}}]),t}(c["default"])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PortfolioItemAddTriggerProxy=t.portfolioItemAddTriggerName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=r(l),c=n(5),s=n(22),p=r(s),d=n(23),y=n(25),m=n(26),h=n(27);t.portfolioItemAddTriggerName="portfolio item add trigger",t.PortfolioItemAddTriggerProxy=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(e){return n._initialize(e)},"initBubble":function(e){return n._configureQuickAddAndFinder(e)}}));return n._options=e,n}return a(t,e),u(t,[{key:"_initialize",value:function(e){this._initConfig=e;var t=this._initConfig.addConfig;t&&(t.addText="Add item:");var n=e.portfolioConfig,r=n.acid,o=n.configParser,i=o.inverse.relationDirection(n);return e.acid=r,e.quickAddDefinition={global:{acid:r},x:i===c.relationDirections.MASTER?"outboundrelations":"inboundrelations",cells:{items:o.inverse.entityTypes(n)}},e}},{key:"_configureQuickAddAxis",value:function(e){var t=this._initConfig.context.configurator.getFeaturesService(),n=!t.isEnabled("disableSliceBase64")&&window.tauFeatures&&window.tauFeatures.hasOwnProperty("disableSliceBase64");return n?(0,p["default"])(e):e}},{key:"_configureQuickAddAndFinder",value:function(e){var t=e.componentsConfig.components,n=this._initConfig.portfolioConfig,r=n.configParser;(0,y.configureDirectChildrenOfType)(t,"board.cell.quick.add",d.portfolioItemQuickAddName,{portfolioConfig:n,options:{action:{x:this._configureQuickAddAxis(this._initConfig.context.entity.id)}}}),(0,y.configureDirectChildrenOfType)(t,"relations.add",m.portfolioItemFinderEmbedderName,{portfolioConfig:n,addConfig:{relationTypes:[this._options.portfolioRelationType],entityTypes:(0,h.toEntityTypes)(r.inverse.entityTypes(n)),finderConfigExtension:{acid:this._initConfig.acid}}})}}]),t}(f["default"])},function(e,t){"use strict";function n(e){var t=window.btoa(e);return"b64_"+t.replace(/\+/g,"_0").replace(/\//g,"_1").replace(/=/g,"_2")+"_"}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PortfolioItemQuickAddProxy=t.portfolioItemQuickAddName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=r(l),c=n(24);t.portfolioItemQuickAddName="portfolio item quick add",t.PortfolioItemQuickAddProxy=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(e){return n._initialize(e)},"afterRender":function(e){return n._preSetRelationTypeAndHide(e)}}));return n._options=e,n}return a(t,e),u(t,[{key:"_initialize",value:function(e){return this._initConfig=e,e}},{key:"_preSetRelationTypeAndHide",value:function(e){var t=this._initConfig.portfolioConfig,n=t.configParser,r=n.inverse.relationDirection(t);(0,c.preSetAndHideRelationTypeSelector)(e.element,r,this._options.portfolioRelationType.id)}}]),t}(f["default"])},function(e,t,n){"use strict";function r(e,t,n){var r=t.toLowerCase()===o.relationDirections.MASTER?"SlaveRelations":"MasterRelations",i=e.find('select[data-fieldname="'+r+':RelationType"]');i.find("[value="+n+"]").prop("selected",!0),i.closest(".tau-field").hide()}Object.defineProperty(t,"__esModule",{value:!0}),t.preSetAndHideRelationTypeSelector=r;var o=n(5)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t,n,r){(0,u.where)(e,{type:t}).forEach(function(e){return(0,a.extend)(!0,e,n&&o({},f["default"],n),r)})}Object.defineProperty(t,"__esModule",{value:!0}),t.configureDirectChildrenOfType=i;var a=n(7),u=n(4),l=n(9),f=r(l)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PortfolioItemFinderEmbedderProxy=t.portfolioItemFinderEmbedderName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=r(l);t.portfolioItemFinderEmbedderName="portfolio item finder embedder",t.PortfolioItemFinderEmbedderProxy=function(e){function t(){var e;return o(this,t),e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(t){return e._initialize(t)},"afterRender":function(t){return e._configureAddMessageAndButton(t)}}))}return a(t,e),u(t,[{key:"_initialize",value:function(e){this._initConfig=e}},{key:"_configureAddMessageAndButton",value:function(e){var t=e.element.find(".quick-add__entity-txt")[0];if(t){var n=this._initConfig.portfolioConfig,r=n.configParser,o=r.inverse.visualization(n).options,i=o.name;t.lastChild.textContent=i.toLowerCase()}return e.element.find(".i-role-relation-type").text("Save"),e}}]),t}(f["default"])},function(e,t){"use strict";function n(e){return e.reduce(function(e,t){var n=r[t];return n&&e.push(n),e},[])}Object.defineProperty(t,"__esModule",{value:!0}),t.toEntityTypes=n;var r=t.entityTypes={project:{id:1,name:"project"},release:{id:2,name:"release"},iteration:{id:3,name:"iteration"},userstory:{id:4,name:"userstory"},task:{id:5,name:"task"},bug:{id:8,name:"bug"},feature:{id:9,name:"feature"},program:{id:10,name:"program"},build:{id:11,name:"build"},testcase:{id:12,name:"testcase"},testplan:{id:13,name:"testplan"},testplanrun:{id:14,name:"testplanrun"},impediment:{id:16,name:"impediment"},request:{id:17,name:"request"},epic:{id:27,name:"epic"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PortfolioItemInnerListProxy=t.portfolioItemInnerListName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=r(l);t.portfolioItemInnerListName="portfolio item inner list",t.PortfolioItemInnerListProxy=function(e){function t(){var e;return o(this,t),e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"afterRender":function(t){return e._hideRelationType(t)}}))}return a(t,e),u(t,[{key:"_hideRelationType",value:function(e){e.element.find(".tau-relation-type").hide()}}]),t}(f["default"])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PortfolioItemFilterProxy=t.portfolioItemFilterName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=r(l),c=n(30);t.portfolioItemFilterName="portfolio item filter",t.PortfolioItemFilterProxy=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(e){return n._initialize(e)},"afterRender":function(e){return n._hideRelationType(e)},"public.relationsReady":function(e){return n._filterRelations(e)}}));
return n._options=e,n}return a(t,e),u(t,[{key:"_initialize",value:function(e){var t=e.portfolioConfig,n=t.configParser;this._relationDirection=n.inverse.relationDirection(t)}},{key:"_hideRelationType",value:function(e){e.element.find(".i-role-filter-relationType").closest(".tau-relations__filters__item").hide()}},{key:"_filterRelations",value:function(e){return(0,c.filterRelationsByTypeAndDirection)(e,this._options.portfolioRelationType,this._relationDirection)}}]),t}(f["default"])},function(e,t,n){"use strict";function r(e,t,n){var r=n?[n]:u,o=u.reduce(function(e,t){return e[t]=[],e},{}),a=[t.id];return r.reduce(function(t,n){return t[n]=(0,i.filter)(e[n],function(e){return(0,i.contains)(a,e.relation.relationType.id)}),t},o)}function o(e,t){var n=[t.id];return u.reduce(function(t,r){return t[r]=(0,i.filter)(e[r],function(e){return!(0,i.contains)(n,e.relation.relationType.id)}),t},e)}Object.defineProperty(t,"__esModule",{value:!0}),t.filterRelationsByTypeAndDirection=r,t.filterRelationsExcludingType=o;var i=n(4),a=n(5),u=(0,i.values)(a.relationDirections)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n=e.filter||"";if(n.length>0){var r=n.replace(/\{\{Filter\}\}/g,t);return"?"+r}return null}function i(e,t){var n=o(e,t);return{types:[e.type],filter:n,useFilter:null!==n}}function a(e,t){var n=(0,m.max)(e,function(e){return e.order}),r=n.order+1;return e.concat({id:t,order:r})}function u(e,t){var n=t.toLowerCase(),r=(0,m.find)(e,function(e){return e.name.toLowerCase()===n});if(!r)throw new Error("Please, check portfolio hierarchy tab mashup config. "+("Looks like hierarchy for '"+t+"' is not defined."));return r}function l(e,t,n){var r=e.map(function(e){var t=e.type,n=t.toLowerCase();return{type:n,units:(C[n]||m.noop)(_["default"])||[]}}),o=(0,v["default"])(t.propagatedCf,n);return r.reduce(function(e,t){if(0===t.units.length)throw new Error("Please, contact support. Portfolio hierarchy tab mashup has no units "+(" for '"+t.type+"' type to show in list."));return e["list_"+t.type]={list:[a(t.units,o)]},e},{})}function f(e,t){var n=t.toLowerCase();return(0,m.find)(e,function(e){return e.type.toLowerCase()===n})}function c(){return{isShow:!0,selectorForHeight:".tau-page-entity",loaderOptions:{loaderType:"logo"}}}function s(e,t){return t?e.id:e.entityType.name+"#"+e.id+" "+e.name}function p(e,t,n){return n?e.propagatedCf+".id=="+t:e.propagatedCf+"=='"+t+"'"}function d(e,t,n,r,o,a,d){var m=a.selectedProjects,h=void 0===m?[]:m,_=a.acid,b=d.configurator.getFeaturesService().isEnabled("useEntityCustomFieldsInHierarchyLinkComponent");return(0,y.when)((0,w["default"])(d)).then(function(t){var n=t.entityType.name,r=e.filteredItemsOpacity,a=e.items,d=f(a,n),y=s(t,b),m=p(d,y,b),v=h.length>0&&h[0].id||null;return{header:[{type:"label",text:o}],items:[{type:"embedded.new.list",name:P.portfolioItemEmbeddedNewListName,treeViewEndPoint:"treeview",lazy:!0,spinnerConfigForLazy:c(),listDefinition:{x:i(u(a,"Product"),m),y:i(u(a,"Subproduct"),m),cells:i(u(a,"Component"),m),cardSettings:l(a,d,b),ignoreColorSettings:!0},listOptions:{quickAddOptions:{disabled:!0},disableLookup:!0},contextOptions:{acid:_,projectIdForTerms:v},portfolioConfig:{useEntityCf:b,fieldName:d.propagatedCf,fieldValue:y,filteredRowsOpacity:r}}]}})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=d;var y=n(7),m=n(4),h=n(32),_=r(h),b=n(33),v=r(b),g=n(35),w=r(g),P=n(36),C={"epic":function(e){return e.getUnitsForEpic()},"feature":function(e){return e.getUnitsForFeature()},"userstory":function(e){return e.getUnitsForUserStory()},"task":function(e){return e.getUnitsForTask()},"bug":function(e){return e.getUnitsForBug()}}},function(e,t){e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){return"custom_field__"+u[t?"entity":"text"]+"__"+a["default"].encodeName(e.toLowerCase())}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var i=n(34),a=r(i),u={text:"100",entity:"entity_name"}},function(e,t){e.exports=i},function(e,t,n){"use strict";function r(e){var t=e.entity,n=e.configurator.getStore2();return n.find(t.entityType.name+"/"+t.id+"?select={id,name,entityType:{entityType.id,entityType.name}}").then(function(e){var t=o(e,1),n=t[0];return(0,i.extend)({},n,{entityType:{name:n.entityType.name.toLowerCase()}})})}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u["return"]&&u["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t["default"]=r;var i=n(4)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){return"tau-list-"+(0,b["default"])(e.toLowerCase())+"-unit"}function l(e,t){var n=e[0].toUpperCase()+e.substring(1).toLowerCase();return"tau-list-"+(0,b["default"])(n,t)+"-cell"}function f(e,t,n){t||(0,w.defer)(function(){var t=e.closest(P);t.find("."+u(n)).hide()})}function c(e,t,n){if(t)return e.filter(function(e,t){return(0,g["default"])(t).find(T).data("entityId")!==n});var r=n.toLowerCase();return e.filter(function(e,t){return(0,g["default"])(t).text().toLowerCase()!==r})}function s(e,t,n,r){var o=c(e,t,n);o.closest(C).css("opacity",r)}function p(e,t){t&&e.each(function(e,t){return(0,g["default"])(t).find(O).hide()})}function d(e,t,n,r,o){var i=e.find("."+l(n,t));t||i.hide(),p(i,t),s(i,t,r,o)}Object.defineProperty(t,"__esModule",{value:!0}),t.PortfolioItemEmbeddedNewListProxy=t.portfolioItemEmbeddedNewListName=void 0;var y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),m=n(12),h=r(m),_=n(33),b=r(_),v=n(7),g=r(v),w=n(4),P=".i-role-list-root-container",C=".tau-elems-table",T="a.tau-id",O="span.click-edit__edit-icon";t.portfolioItemEmbeddedNewListName="portfolio item embedded new list",t.PortfolioItemEmbeddedNewListProxy=function(e){function t(){var e;return o(this,t),e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(t){return e._initialize(t)},"view.cell.changed":function(t){return e._patchListViewCells(t)}}))}return a(t,e),y(t,[{key:"_initialize",value:function(e){var t=e.portfolioConfig,n=t.useEntityCf,r=t.fieldName,o=t.fieldValue,i=t.filteredRowsOpacity;this._showEntityField=n,this._fieldName=r,this._fieldValue=o,this._filteredRowsOpacity=i}},{key:"_patchListViewCells",value:function(e){f(e,this._showEntityField,this._fieldName),d(e,this._showEntityField,this._fieldName,this._fieldValue,this._filteredRowsOpacity)}}]),t}(h["default"])},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(7),a=n(14),u=function(){function e(t,n,o){r(this,e),this._context=t,this._customFieldConfig=n,this._storageService=o}return o(e,[{key:"_configurator",get:function(){return this._context.configurator}}]),o(e,[{key:"generateContext",value:function(e){var t=this;return e===a.itemTypes.NONE?(0,i.when)(null):this._retrieveKnownItemPossibleProjectIds(e).then(function(e){return t._retrieveContext(e)})}},{key:"canGenerateContext",value:function(e){return e===a.itemTypes.NONE?(0,i.when)(!1):this._retrieveKnownItemPossibleProjectIds(e).then(function(e){return e.length>0})}},{key:"_retrieveKnownItemPossibleProjectIds",value:function(e){return this._storageService.retrieveKnownItemPossibleProjectIds(e,this._customFieldConfig)}},{key:"_retrieveContext",value:function(e){if(0===e.length)return null;var t=this._configurator.getApplicationContextService();return t.getApplicationContext({projectIds:e,teamIds:["*"]})}}]),e}();t["default"]=u},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={TAB:"tab",COMPONENT:"component"}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t,n){var r=n.inverse.visualization(t),o=r.options,i=(0,s.omit)(o,"name","type","insertAfter"),a=(0,s.extend)(i,{itemTypeCf:{name:e,value:t.name},dependencyType:n.inverse.relationDirection(t),relationType:b["default"].link});return{name:o.name,type:o.type||o.name,configuration:a}}Object.defineProperty(t,"__esModule",{value:!0}),t.EntityViewProxy=t.entityViewName=void 0;var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(7),s=n(4),p=n(12),d=r(p),y=n(37),m=r(y),h=n(15),_=n(10),b=r(_),v=n(38),g=r(v),w=n(13),P=r(w);t.entityViewName="entity component",t.EntityViewProxy=function(e){function t(e){var n;return i(this,t),n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"contextRetrieved":function(t){return n._setPatchViewData(t,e)},"initializeContainer":function(t){return n._patchView(t,e)},"destroy":function(){return n._resetViewCaches()}}))}return u(t,e),f(t,[{key:"_setPatchViewData",value:function(e,t){var n=this,r=e.context,o=r.configurator;return this._storageService=new P["default"](o),this._patchViewDataPromise=(0,h.getItemTypeConfigByContext)(r,{customFieldName:t.portfolioTypeCustomFieldName,portfolioConfigs:t.portfolioConfigs,visualizationType:g["default"].COMPONENT},this._storageService).then(function(e){return n._filterPatchViewData(e,r,t)}),e}},{key:"_patchView",value:function(e,t){var n=this,r=t.portfolioTypeCustomFieldName;return this._doIfNeedPatchView(function(t){var o=(0,s.extend)({customFieldName:r},t);n._patchViewSection(e,o),n._patchCustomFieldsBox(e,o)}).then(function(){return e})}},{key:"_resetViewCaches",value:function(){this._storageService&&this._storageService.destroy()}},{key:"_filterPatchViewData",value:function(e,t,n){var r=this,i=n.portfolioTypeCustomFieldName;if(null===e)return null;var a=e.portfolioConfigs.map(function(n){var o=new m["default"](t,{name:i,value:n.name},r._storageService);return o.canGenerateContext(e.inverseItemType).then(function(e){return{canGenerateContext:e,portfolioConfig:n}})});return c.when.apply(void 0,o(a)).then(function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.accessiblePortfolioConfigs=n.filter(function(e){return e.canGenerateContext}).map(function(e){return e.portfolioConfig}),e})}},{key:"_doIfNeedPatchView",value:function(e){return this._patchViewDataPromise.then(function(t){null!==t&&e(t)})}},{key:"_patchViewSection",value:function(e,t){var n=this,r=t.entityType,o=t.customFieldName,i=t.accessiblePortfolioConfigs,a=t.configParser;i.forEach(function(t){var i=a.inverse.visualization(t).options,u=i.insertAfter,l=n._extractSectionConfigs(e,u.section);null!==l&&n._insertSectionConfigs(l,t,r,o,a)})}},{key:"_insertSectionConfigs",value:function(e,t,n,r,o){var i=l(r,t,o),a=this._computeConfigPosition(e,n,o.inverse.visualization(t));null!==a&&e.splice(a,0,i)}},{key:"_extractSectionConfigs",value:function(e,t){if("info"===t){var n=this._lastInHierarchy(e,["main entity container","additional info column container","additional_lazy info column container","additional info container"]),r=(0,s.find)(n.items||[],function(e){return"additionalInfo"===e.type});return r&&r.children||null}return null}},{key:"_computeConfigPosition",value:function(e,t,n){var r=n.options,o=r.insertAfter.position[t.name];if(null===o)return 0;var i=o.toLowerCase(),a=(0,s.findIndex)(e,function(e){return e.label&&e.label.text.toLowerCase()===i||e.name&&e.name.toLowerCase()===i});return a===-1?0:a+1}},{key:"_lastInHierarchy",value:function(e,t){return t.reduce(function(e,t){return(0,s.find)(e.children||[],function(e){return e.name===t})},e)}},{key:"_patchCustomFieldsBox",value:function(e,t){var n=t.portfolioConfigs,r=t.configParser,o=this._lastInHierarchy(e,["main entity container","additional info column container","additional_lazy info column container"]),i=o.children||[],a=(0,s.find)(i,function(e){return"collapsible.customFields"===e.type});if(a){var u=this._extractCustomFieldsToHide(n,r);a.items=this._filterHiddenCustomFields(a.items,u)}}},{key:"_extractCustomFieldsToHide",value:function(e,t){return e.reduce(function(e,n){var r=t.inverse.visualization(n).options,i=r.items||[];return i.reduce(function(e,t){var n=(0,s.values)((0,s.pick)(t,"directCf","propagatedCf"));return e.push.apply(e,o(n)),e},e)},[])}},{key:"_filterHiddenCustomFields",value:function(e,t){return t.length>0?(0,s.reject)(e,function(e){return(0,s.some)(t,function(t){return e.customField&&t===e.customField.name})}):e}}]),t}(d["default"])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RelationContainerProxy=t.relationContainerName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=r(l),c=n(41),s=n(44),p=n(45),d=n(25),y=n(30);t.relationContainerName="relations container",t.RelationContainerProxy=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(e){return n._initialize(e)},"public.relationsReady":function(e){return n._filterRelations(e)}}));return n._options=e,n}return a(t,e),u(t,[{key:"_initialize",value:function(e){return this._initConfig=e,(0,d.configureDirectChildrenOfType)(e.children,"relations.list",c.relationListName,{relationConfig:{extensionsConfig:{RelationsDenied:function e(){o(this,e)}}}}),(0,d.configureDirectChildrenOfType)(e.children,"relations.filter",s.relationFilterName),(0,d.configureDirectChildrenOfType)(e.children,"relations.connection",p.relationConnectionName),e}},{key:"_filterRelations",value:function(e){return(0,y.filterRelationsExcludingType)(e,this._options.portfolioRelationType)}}]),t}(f["default"])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RelationListProxy=t.relationListName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=r(l),c=n(42),s=n(25);t.relationListName="relation list",t.RelationListProxy=function(e){function t(){var e;return o(this,t),e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(t){return e._initialize(t)}}))}return a(t,e),u(t,[{key:"_initialize",value:function(e){return(0,s.configureDirectChildrenOfType)(e.children,"relations.add.trigger",c.relationAddTriggerName),e}}]),t}(f["default"])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RelationAddTriggerProxy=t.relationAddTriggerName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=r(l),c=n(43),s=n(25),p=n(10),d=r(p);t.relationAddTriggerName="relation add trigger",t.RelationAddTriggerProxy=function(e){function t(){var e;return o(this,t),e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(t){return e._initialize(t)},"initBubble":function(t){return e._configureQuickAddAndFinder(t)}}))}return a(t,e),u(t,[{key:"_initialize",value:function(e){return this._initConfig=e,e}},{key:"_configureQuickAddAndFinder",value:function(e){var t=e.componentsConfig.components;(0,s.configureDirectChildrenOfType)(t,"board.cell.quick.add",c.relationQuickAddName),(0,s.configureDirectChildrenOfType)(t,"relations.add",null,{addConfig:{relationTypes:[d["default"].blocker,d["default"].dependency,d["default"].duplicate,d["default"].relation]}})}}]),t}(f["default"])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RelationQuickAddProxy=t.relationQuickAddName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=r(l);t.relationQuickAddName="relation quick add",t.RelationQuickAddProxy=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(e){return n._initialize(e)},"afterRender":function(e){return n._hidePortfolioRelationType(e)}}));return n._options=e,n}return a(t,e),u(t,[{key:"_initialize",value:function(e){return this._initConfig=e,e}},{key:"_hidePortfolioRelationType",value:function(e){e.element.find('select[data-fieldname$=":RelationType"] option[value='+this._options.portfolioRelationType.id+"]").hide()}}]),t}(f["default"])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RelationFilterProxy=t.relationFilterName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=r(l),c=n(30);t.relationFilterName="relation filter",t.RelationFilterProxy=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"public.relationsReady":function(e){return n._filterRelations(e)}}));return n._options=e,n}return a(t,e),u(t,[{key:"_filterRelations",value:function(e){return(0,c.filterRelationsExcludingType)(e,this._options.portfolioRelationType)}}]),t}(f["default"])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RelationConnectionProxy=t.relationConnectionName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=r(l);t.relationConnectionName="relation connection",t.RelationConnectionProxy=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(e){return n._initialize(e)},"dataBind":function(e){return n._getRelationCounts(e)}}));return n._options=e,n}return a(t,e),u(t,[{key:"_initialize",value:function(e){return this._initConfig=e,e}},{key:"_getRelationCounts",value:function(){var e=this._initConfig.context,t=e.configurator.getStore2(),n=e.entity.id,r=this._options.portfolioRelationType.id,o="relationType.id!="+r,i="masterRelationsCount:masterRelations.Where("+o+").Count(),"+("slaveRelationsCount:slaveRelations.Where("+o+").Count()");return t.findAll("general?select={"+encodeURIComponent(i)+"}&where=(id=="+n+")").then(function(e){return e[0]})}}]),t}(f["default"])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RelationTabContainerProxy=t.relationTabContainerName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=r(l),c=n(25);t.relationTabContainerName="relations tab container",t.RelationTabContainerProxy=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(e){return n._initialize(e)}}));return n._options=e,n}return a(t,e),u(t,[{key:"_initialize",value:function(e){var t=this._options.portfolioRelationType.id,n="relationType.id!="+t;return(0,c.configureDirectChildrenOfType)(e.children,"label.relationCount",null,{dataSelector:"totalRelationCount:masterRelations.Where("+n+").Count()+slaveRelations.Where("+n+").Count(),"+("blockerRelationCount:masterRelations.Where("+n+").ActiveMasterRelationsCount().openBlockers,")+("masterRelations:masterRelations.Where("+n+").Select({id,masterId:master.id})")}),e}}]),t}(f["default"])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RelationTypeChoiceProxy=t.relationTypeChoiceName=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=r(l);t.relationTypeChoiceName="choice relationType",t.RelationTypeChoiceProxy=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{"initialize":function(e){return n._initialize(e)},"dataBind":function(e){return n._filterPortfolioRelationType(e)}}));return n._options=e,n}return a(t,e),u(t,[{key:"_initialize",value:function(e){return this._initConfig=e,e}},{key:"_filterPortfolioRelationType",value:function(e){var t=this;return e.states=e.states.filter(function(e){return e.id!==t._options.portfolioRelationType.id}),e}}]),t}(f["default"])}])})}();
